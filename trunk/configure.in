AC_INIT
AC_CONFIG_SRCDIR([src/statelessjniloader.c])
AC_CONFIG_AUX_DIR(config)
AC_CONFIG_MACRO_DIR([m4])

AC_PROG_CC
AC_LANG_C

AC_CANONICAL_BUILD
AC_CANONICAL_HOST
AC_CANONICAL_TARGET

AC_PROG_MAKE_SET
AC_PROG_INSTALL

AM_INIT_AUTOMAKE("statelessjniloader", 0.0.1)
AM_DISABLE_STATIC
AM_PROG_LIBTOOL

dnl dlopen section
AC_CHECK_HEADER(dlfcn.h,,AC_MSG_ERROR(missing dlfcn.h))

dnl JNI section
JAVAC=javac
AC_ARG_WITH(javac,[  --with-javac=JAVAC       Path to javac],JAVAC=$withval,)
AC_JNI_INCLUDE_DIR
for JNI_INCLUDE_DIR in $JNI_INCLUDE_DIRS
do
  CPPFLAGS="$CPPFLAGS -I$JNI_INCLUDE_DIR"
done
AC_CHECK_HEADER(jni.h,,AC_MSG_ERROR(jni not found))
JMODSUFFIX_CONFIG

dnl OS X JNI install location kludge
if test `uname` = "Darwin"; then
  libdir="/Library/Java/Extensions"
fi

AC_CONFIG_FILES([Makefile src/Makefile],)
AC_OUTPUT
